{
  "version": 3,
  "sources": [
    "books-babel.js"
  ],
  "names": [
    "ApiResponse",
    "pathname",
    "window",
    "location",
    "bookTableColumns",
    "messageLocation",
    "myBooksStyle",
    "display",
    "notMyBooksStyle",
    "searchBooksStyle",
    "DisplayBooks",
    "props",
    "state",
    "users",
    "input",
    "bind",
    "clickSearch",
    "requestBook",
    "cancelRequest",
    "acceptRequest",
    "rejectRequest",
    "cancelLoan",
    "deleteBook",
    "searchFilterArray",
    "username",
    "city",
    "country",
    "$",
    "post",
    "info",
    "status",
    "getOrUpdateBooks",
    "getMeAndRelatedUsers",
    "get",
    "data",
    "userA",
    "usernames",
    "i",
    "local",
    "borrowingFrom",
    "length",
    "push",
    "requestsTo",
    "books",
    "lendingTo",
    "requestsFrom",
    "j",
    "uniqueUsernames",
    "filter",
    "elem",
    "index",
    "self",
    "indexOf",
    "searchFilter",
    "getBooks",
    "user_name",
    "ajax",
    "url",
    "type",
    "dataType",
    "success",
    "setState",
    "user",
    "userIndex",
    "findUserIndex",
    "JSON",
    "parse",
    "stringify",
    "splice",
    "enteredIsbn",
    "value",
    "isbn",
    "replace",
    "toUpperCase",
    "findUser",
    "userStringifiedOriginal",
    "isbns",
    "displayMessage",
    "callApi",
    "key",
    "book",
    "updateOneUser",
    "getOrUpdateOneBook",
    "message",
    "selector",
    "textContent",
    "css",
    "fadeOut",
    "src",
    "attr",
    "appendTo",
    "remove",
    "cityName",
    "stateName",
    "countryName",
    "updateBooks",
    "e",
    "which",
    "target",
    "id",
    "addBook",
    "filteredSearch",
    "details",
    "split",
    "owner",
    "userBIndex",
    "bookIndex",
    "userB",
    "userBStringifiedOriginal",
    "userAStringifiedOriginal",
    "requestsToIndex",
    "findLocalIndex",
    "userObject",
    "userAObject",
    "userAIndex",
    "updateTwoUsers",
    "requestsToArr",
    "isbnIndex",
    "requestsFromArr",
    "firstName",
    "lastName",
    "email",
    "dataA",
    "dataB",
    "localArr",
    "arr",
    "requester",
    "lendingToObject",
    "borrowingFromArr",
    "borrowingFromIndex",
    "borrower",
    "me",
    "paddingTop",
    "visibility",
    "React",
    "Component",
    "Users",
    "map",
    "BookRows",
    "totalUserBooks",
    "bookRow",
    "bookRows",
    "row",
    "Books",
    "rowIndex",
    "cover",
    "medium",
    "requestsFromUsernameFound",
    "lendingToUsernameFound",
    "combinedStyle",
    "requestButtonStyle",
    "cancelRequestButtonStyle",
    "onLoanToInfo",
    "displayedEmail",
    "onLoanToEmailDisplayStyle",
    "onLoanInfo",
    "ownerDetailsDisplayStyle",
    "requestsFromCount",
    "cancelLoanButtonStyle",
    "cancelLoanButtonId",
    "deleteBookButtonStyle",
    "title",
    "authors",
    "name",
    "RequestsFrom",
    "acceptRequestIconStyle",
    "ReactDOM",
    "render",
    "document",
    "getElementById"
  ],
  "mappings": "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",
  "file": "books-babel.js",
  "sourceRoot": "../../../src/public/javascripts",
  "sourcesContent": [
    "var ApiResponse // must be defined globally to work\r\nvar pathname = window.location.pathname\r\nvar bookTableColumns = 4\r\nvar messageLocation\r\nvar myBooksStyle\r\npathname === '/myBooks' ? myBooksStyle = {display: ''} : myBooksStyle = {display: 'none'}\r\nvar notMyBooksStyle\r\npathname !== '/myBooks' ? notMyBooksStyle = {display: ''} : notMyBooksStyle = {display: 'none'}\r\nvar searchBooksStyle\r\npathname === '/searchBooks' ? searchBooksStyle = {display: ''} : searchBooksStyle = {display: 'none'}\r\n\r\nclass DisplayBooks extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      users: []\r\n    }\r\n    this.input = this.input.bind(this)\r\n    this.clickSearch = this.clickSearch.bind(this)\r\n    this.requestBook = this.requestBook.bind(this)\r\n    this.cancelRequest = this.cancelRequest.bind(this)\r\n    this.acceptRequest = this.acceptRequest.bind(this)\r\n    this.rejectRequest = this.rejectRequest.bind(this)\r\n    this.cancelLoan = this.cancelLoan.bind(this)\r\n    this.deleteBook = this.deleteBook.bind(this)\r\n  }\r\n  componentWillMount() {\r\n    if (pathname === '/searchBooks') {\r\n      var searchFilterArray = [{ 'local.username': username }, { 'local.city': city, 'local.state': state, 'local.country': country }] // don't forget logged in user!\r\n      $.post('/api/filteredSearch', { searchFilterArray: searchFilterArray }, (info, status) => {\r\n        this.getOrUpdateBooks(info)\r\n      })\r\n    }\r\n    else {\r\n      this.getMeAndRelatedUsers()\r\n    }\r\n  }\r\n  getMeAndRelatedUsers() {\r\n    $.get('/api/getMyBooks', function(data, status) {\r\n      var userA = data[0]\r\n      var usernames = []\r\n      for (let i = 0; i < userA.local.borrowingFrom.length; i++) {\r\n        usernames.push(userA.local.borrowingFrom[i].local.username)\r\n      }\r\n      for (let i = 0; i < userA.local.requestsTo.length; i++) {\r\n        usernames.push(userA.local.requestsTo[i].local.username)\r\n      }\r\n      for (let i = 0; i < userA.local.books.length; i++) {\r\n        if (userA.local.books[i].lendingTo) usernames.push(userA.local.books[i].lendingTo.local.username)\r\n        if (userA.local.books[i].requestsFrom) {\r\n          for (let j = 0; j < userA.local.books[i].requestsFrom.length; j++) {\r\n            usernames.push(userA.local.books[i].requestsFrom[j].local.username)\r\n          }\r\n        }\r\n      }\r\n      var uniqueUsernames = usernames.filter(function(elem, index, self) {\r\n        return index === self.indexOf(elem);\r\n      })\r\n      var searchFilterArray = []\r\n      searchFilterArray.push({ 'local.username': username }) // don't forget logged in user!\r\n      for (let i = 0; i < uniqueUsernames.length; i++) {\r\n        var searchFilter = {}\r\n        searchFilter['local.username'] = uniqueUsernames[i]\r\n        searchFilterArray.push(searchFilter)\r\n      }\r\n      $.post('/api/filteredSearch', { searchFilterArray: searchFilterArray }, function(info, status) {\r\n        getBooks(info)\r\n      })\r\n    })\r\n    var getBooks = (users) => {\r\n      this.getOrUpdateBooks(users)\r\n    }\r\n  }\r\n  getUserBooks(user_name) {\r\n    $.ajax({\r\n      url: '/api/getUserBooks',\r\n      type: 'POST',\r\n      dataType: 'JSON', //specifies the expected response data type which is used as an argument in the 'success' function\r\n      data: {username: user_name},\r\n      success: (users) => {\r\n        this.getOrUpdateBooks(users)\r\n      }\r\n    })\r\n  }\r\n  getOrUpdateBooks(users) {\r\n    this.setState({\r\n      users: users\r\n    })\r\n  }\r\n  getOrUpdateOneBook(user) {\r\n    var userIndex = this.findUserIndex(username)\r\n    var users = JSON.parse(JSON.stringify(this.state.users))\r\n    users.splice(userIndex, 1)\r\n    users.splice(userIndex, 0, user)\r\n    this.setState({\r\n      users: users\r\n    })\r\n  }\r\n  addBook() {\r\n    var enteredIsbn = $('#bookSearchBox')[0].value\r\n    var isbn = enteredIsbn.replace(/[^0-9a-z]/gi, '').toUpperCase()\r\n    $('#bookSearchBox')[0].value = ''\r\n    var user = this.findUser(username)\r\n    var userStringifiedOriginal = JSON.stringify(user)\r\n    var isbns = user.local.isbns\r\n    if (!enteredIsbn) {\r\n      this.displayMessage('book ISBN field empty!')\r\n    } else if (isbn.length < 10) {// ISBNs have either 10 or 13 characters\r\n      this.displayMessage('ISBN too short!')\r\n    } else if (isbns.indexOf(isbn) !== -1) {\r\n      this.displayMessage('book already added!')\r\n    } else {\r\n      this.callApi(isbn)\r\n    }\r\n    ApiResponse = (data) => {\r\n      var key = 'ISBN:' + isbn\r\n      if (!data[key]) {\r\n        this.displayMessage('ISBN not found!')\r\n      } else {\r\n        var book = data[key]\r\n        user.local.books.push(book)\r\n        user.local.isbns.push(isbn)\r\n        this.updateOneUser(user, userStringifiedOriginal)\r\n      }\r\n    }\r\n  }\r\n  updateOneUser(user, userStringifiedOriginal) {\r\n    $.post('/api/updateOneUser', {\r\n      user: user, // any empty arrays in data will be removed from req.body\r\n      userStringifiedOriginal: userStringifiedOriginal\r\n    },\r\n    (data, status) => {\r\n      if (typeof data === 'string') {\r\n        this.displayMessage(data)\r\n      } else {\r\n        this.getOrUpdateOneBook(data)\r\n      }\r\n    })\r\n  }\r\n  displayMessage(message) {\r\n    var selector\r\n    messageLocation ? selector = $('#message_' + messageLocation) : selector = $('#message')\r\n    selector[0].textContent = message\r\n    selector.css('visibility', 'visible')\r\n    selector.fadeOut(3000, function() {//function actions performed AFTER fadeOut\r\n      selector.css('display', '')\r\n      selector.css('visibility', 'hidden')\r\n    })\r\n  }\r\n  callApi(isbn) {\r\n    var src = \"https://openlibrary.org/api/books?bibkeys=ISBN:\" + isbn + \"&jscmd=data&callback=ApiResponse\"\r\n    $('<script>').attr({'id': 'callApi', 'src': src}).appendTo('head') // can append to head or body, after which api is automatically called\r\n    $('#callApi').remove()\r\n  }\r\n  filteredSearch() {\r\n    var cityName = $('#city')[0].value.toUpperCase()\r\n    var stateName = $('#state')[0].value.toUpperCase()\r\n    var countryName = $('#country')[0].value.toUpperCase()\r\n    // set mongoose search filter object\r\n    var searchFilter = {}\r\n    if (cityName) searchFilter['local.city'] = cityName\r\n    if (stateName) searchFilter['local.state'] = stateName\r\n    if (countryName) searchFilter['local.country'] = countryName\r\n    var searchFilterArray = []\r\n    searchFilterArray.push({ 'local.username': username }, searchFilter ) // don't forget logged in user!\r\n    $.ajax({\r\n      url: '/api/filteredSearch',\r\n      type: 'POST',\r\n      dataType: 'JSON', //specifies the expected response data type which is used as an argument in the 'success' function\r\n      data: {\r\n        searchFilterArray: searchFilterArray\r\n      },\r\n      success: function(users) {\r\n        updateBooks(users)\r\n      }\r\n    })\r\n    var updateBooks = (users) => {\r\n      this.getOrUpdateBooks(users)\r\n    }\r\n  }\r\n  input(e) {\r\n    messageLocation = null\r\n    if (e.which === 13) {\r\n      if (e.target.id === 'bookSearchBox') {\r\n        this.addBook()\r\n      } else {\r\n        this.filteredSearch()\r\n      }\r\n    }\r\n  }\r\n  clickSearch(e) {\r\n    messageLocation = null\r\n    if (e.target.id === 'bookSearchButton') {\r\n      this.addBook()\r\n    } else {\r\n      this.filteredSearch()\r\n    }\r\n  }\r\n  requestBook(e) {\r\n    var details = e.target.id.split('_')\r\n    var owner = details[1]// = userB.local.username\r\n    var userBIndex = details[2]\r\n    var bookIndex = details[3]\r\n    messageLocation = userBIndex + '_' + bookIndex\r\n    var userB = this.findUser(owner)\r\n    var userBStringifiedOriginal = JSON.stringify(userB)\r\n    var userA = this.findUser(username)\r\n    var userAStringifiedOriginal = JSON.stringify(userA)\r\n    var isbn = userB.local.isbns[bookIndex]\r\n    var requestsToIndex = this.findLocalIndex(owner, userA.local.requestsTo)\r\n    if (requestsToIndex === -1) {\r\n      userA.local.requestsTo.push(this.userObject(owner))\r\n      userA.local.requestsTo[userA.local.requestsTo.length - 1].local.isbns = [isbn]\r\n    } else {\r\n      userA.local.requestsTo[requestsToIndex].local.isbns.push(isbn)\r\n    }\r\n    var userAObject = this.userObject(username)\r\n    userB.local.books[bookIndex].requestsFrom ? userB.local.books[bookIndex].requestsFrom.push(userAObject) : userB.local.books[bookIndex].requestsFrom = [userAObject]\r\n    var userAIndex = this.findUserIndex(username)\r\n    this.updateTwoUsers(userA, userAStringifiedOriginal, userAIndex, userB, userBStringifiedOriginal, userBIndex)\r\n  }\r\n  cancelRequest(e) {\r\n    var details = e.target.id.split('_')\r\n    var owner = details[1]// = userB.local.username\r\n    var userBIndex = details[2]\r\n    var bookIndex = details[3]\r\n    messageLocation = userBIndex + '_' + bookIndex\r\n    var userB = this.findUser(owner)\r\n    var userBStringifiedOriginal = JSON.stringify(userB)\r\n    var isbn = userB.local.isbns[bookIndex]\r\n    var userA = this.findUser(username)\r\n    var userAStringifiedOriginal = JSON.stringify(userA)\r\n    // depopulate requestsTo array\r\n    var requestsToArr = userA.local.requestsTo\r\n    var requestsToIndex = this.findLocalIndex(owner, requestsToArr)\r\n    if (userA.local.requestsTo[requestsToIndex].local.isbns.length > 1) {// state should be modified after updateTwoUsers called\r\n      var isbnIndex = userA.local.requestsTo[requestsToIndex].local.isbns.indexOf(isbn)\r\n      userA.local.requestsTo[requestsToIndex].local.isbns.splice(isbnIndex, 1)\r\n    } else {\r\n      userA.local.requestsTo.splice(requestsToIndex, 1)\r\n    }\r\n    var requestsFromArr = userB.local.books[bookIndex].requestsFrom\r\n    userB.local.books[bookIndex].requestsFrom.splice(this.findLocalIndex(username, requestsFromArr), 1)\r\n    var userAIndex = this.findUserIndex(username)\r\n    this.updateTwoUsers(userA, userAStringifiedOriginal, userAIndex, userB, userBStringifiedOriginal, userBIndex)\r\n  }\r\n  findUserIndex(user_name) {\r\n    var users = this.state.users\r\n    for (let i = 0; i < users.length; i++) {\r\n      if (users[i].local.username === user_name) {\r\n        return i\r\n      }\r\n    }\r\n    return null\r\n  }\r\n  findUser(user_name) {\r\n    var users = JSON.parse(JSON.stringify(this.state.users))\r\n    for (let i = 0; i < users.length; i++) {\r\n      if (users[i].local.username === user_name) {\r\n        return users[i]\r\n      }\r\n    }\r\n    return null\r\n  }\r\n  userObject(user_name) {\r\n    var user = this.findUser(user_name)\r\n    return ({\r\n      local: {\r\n        firstName: user.local.firstName,\r\n        lastName: user.local.lastName,\r\n        username: user.local.username,\r\n        city: user.local.city,\r\n        state: user.local.state,\r\n        country: user.local.country,\r\n        email: user.local.email\r\n      }\r\n    })\r\n  }\r\n  updateTwoUsers(userA, userAStringifiedOriginal, userAIndex, userB, userBStringifiedOriginal, userBIndex) {\r\n    var users = JSON.parse(JSON.stringify(this.state.users))\r\n    $.post('/api/updateTwoUsers', {\r\n      userA: userA,\n      userAStringifiedOriginal: userAStringifiedOriginal,\r\n      userB: userB,\n      userBStringifiedOriginal: userBStringifiedOriginal\r\n    },\r\n    (data, status) => {\r\n      if (typeof data === 'string') {\r\n        this.displayMessage(data)\r\n      } else {\r\n        var dataA = data[0]\r\n        var dataB = data[1]\r\n        users.splice(userAIndex, 1)\r\n        users.splice(userAIndex, 0, dataA)\r\n        users.splice(userBIndex, 1)\r\n        users.splice(userBIndex, 0, dataB)\r\n        this.getOrUpdateBooks(users)\r\n      }\r\n    })\r\n  }\r\n  findLocalIndex(user_name, localArr) {\r\n    for (let i = 0; i < localArr.length; i++) {\r\n      if (localArr[i].local.username === user_name) {\r\n        return i\r\n      }\r\n    }\r\n    return -1\r\n  }\r\n  acceptRequest(e) {\r\n    var arr = e.target.id.split('_')\r\n    var requester = arr[1]\r\n    var isbn = arr[2]\r\n    var bookIndex = arr[3]\r\n    var userA = this.findUser(username)\r\n    var userAStringifiedOriginal = JSON.stringify(userA)\r\n    var requestsFromArr = userA.local.books[bookIndex].requestsFrom\r\n    var lendingToObject = userA.local.books[bookIndex].requestsFrom.splice(this.findLocalIndex(requester, requestsFromArr), 1)[0]\r\n    userA.local.books[bookIndex].lendingTo = lendingToObject\r\n    var userB = this.findUser(requester)\r\n    var userBStringifiedOriginal = JSON.stringify(userB)\r\n    // populate borrowingFrom array\r\n    var borrowingFromArr = userB.local.borrowingFrom\r\n    var borrowingFromIndex = this.findLocalIndex(username, borrowingFromArr)\r\n    if (borrowingFromIndex === -1) {\r\n      userB.local.borrowingFrom.push(this.userObject(username))\r\n      userB.local.borrowingFrom[borrowingFromArr.length - 1].local.isbns = [isbn]\r\n    } else {\r\n      userB.local.borrowingFrom[borrowingFromIndex].local.isbns.push(isbn)\r\n    }\r\n    // depopulate requestsTo array\r\n    var requestsToArr = userB.local.requestsTo\r\n    var requestsToIndex = this.findLocalIndex(username, requestsToArr)\r\n    if (userB.local.requestsTo[requestsToIndex].local.isbns.length > 1) {\r\n      var isbnIndex = userB.local.requestsTo[requestsToIndex].local.isbns.indexOf(isbn)\r\n      userB.local.requestsTo[requestsToIndex].local.isbns.splice(isbnIndex, 1)\r\n    } else {\r\n      userB.local.requestsTo.splice(requestsToIndex, 1)\r\n    }\r\n    var userAIndex = this.findUserIndex(username)\r\n    var userBIndex = this.findUserIndex(requester)\r\n    messageLocation = userAIndex + '_' + bookIndex\r\n    this.updateTwoUsers(userA, userAStringifiedOriginal, userAIndex, userB, userBStringifiedOriginal, userBIndex)\r\n  }\r\n  rejectRequest(e) {\r\n    var arr = e.target.id.split('_')\r\n    var requester = arr[1]\r\n    var isbn = arr[2]\r\n    var bookIndex = arr[3]\r\n    var userA = this.findUser(username)\r\n    var userAStringifiedOriginal = JSON.stringify(userA)\r\n    var requestsFromArr = userA.local.books[bookIndex].requestsFrom\r\n    userA.local.books[bookIndex].requestsFrom.splice(this.findLocalIndex(requester, requestsFromArr), 1)\r\n    var userB = this.findUser(requester)\r\n    var userBStringifiedOriginal = JSON.stringify(userB)\r\n    // depopulate requestsTo array\r\n    var requestsToArr = userB.local.requestsTo\r\n    var requestsToIndex = this.findLocalIndex(username, requestsToArr)\r\n    if (userB.local.requestsTo[requestsToIndex].local.isbns.length > 1) {\r\n      var isbnIndex = userB.local.requestsTo[requestsToIndex].local.isbns.indexOf(isbn)\r\n      userB.local.requestsTo[requestsToIndex].local.isbns.splice(isbnIndex, 1)\r\n    } else {\r\n      userB.local.requestsTo.splice(requestsToIndex, 1)\r\n    }\r\n    var userAIndex = this.findUserIndex(username)\r\n    var userBIndex = this.findUserIndex(requester)\r\n    messageLocation = userAIndex + '_' + bookIndex\r\n    this.updateTwoUsers(userA, userAStringifiedOriginal, userAIndex, userB, userBStringifiedOriginal, userBIndex)\r\n  }\r\n  cancelLoan(e) {\r\n    var arr = e.target.id.split('_')\r\n    var borrower = arr[1]\r\n    var isbn = arr[2]\r\n    var bookIndex = arr[3]\r\n    var userA = this.findUser(username)\r\n    var userAStringifiedOriginal = JSON.stringify(userA)\r\n    userA.local.books[bookIndex].lendingTo = {}\r\n    var userB = this.findUser(borrower)\r\n    var userBStringifiedOriginal = JSON.stringify(userB)\r\n    // depopulate borrowingFrom array\r\n    var borrowingFromArr = userB.local.borrowingFrom\r\n    var borrowingFromIndex = this.findLocalIndex(username, borrowingFromArr)\r\n    if (userB.local.borrowingFrom[borrowingFromIndex].local.isbns.length > 1) {\r\n      var isbnIndex = userB.local.borrowingFrom[borrowingFromIndex].local.isbns.indexOf(isbn)\r\n      userB.local.borrowingFrom[borrowingFromIndex].local.isbns.splice(isbnIndex, 1)\r\n    } else {\r\n      userB.local.borrowingFrom.splice(borrowingFromIndex, 1)\r\n    }\r\n    var userAIndex = this.findUserIndex(username)\r\n    var userBIndex = this.findUserIndex(borrower)\r\n    messageLocation = userAIndex + '_' + bookIndex\r\n    this.updateTwoUsers(userA, userAStringifiedOriginal, userAIndex, userB, userBStringifiedOriginal, userBIndex)\r\n  }\r\n  deleteBook(e) {\r\n    var arr = e.target.id.split('_')\r\n    var isbn = arr[1]\r\n    var bookIndex = arr[2]\r\n    var user = this.findUser(username)\r\n    var userStringifiedOriginal = JSON.stringify(user)\r\n    user.local.isbns.splice(bookIndex, 1)\r\n    user.local.books.splice(bookIndex, 1)\r\n    this.updateOneUser(user, userStringifiedOriginal)\r\n    var userAIndex = this.findUserIndex(username)\r\n    messageLocation = userAIndex + '_' + bookIndex\r\n  }\r\n  render() {\r\n    var me = this.state.users[this.findUserIndex(username)]\r\n    if (!(pathname === '/myRequestsAndBorrowings' && me && me.local.requestsTo.length === 0 && me.local.borrowingFrom.length === 0)) {\r\n      return (\r\n        <div className='frame' style={{paddingTop: '0px'}}>\r\n          <div className='page'>\r\n            <div className='formBox'>\r\n              <h5 style={myBooksStyle}>Add books I own and want to loan out to my collection:</h5>\r\n              <h5 style={searchBooksStyle}>Search for books in:</h5>\r\n              <input id='bookSearchBox' className='bookSearchInput' type='text' placeholder='Enter book ISBN' style={myBooksStyle} onKeyDown={this.input} />\r\n              <button id='bookSearchButton' style={myBooksStyle} onClick={this.clickSearch}>Add book</button>\r\n              <div style={myBooksStyle}><div id={'message'} style={{visibility: 'hidden'}}>Filler</div></div>\r\n              <input id='city' className='bookSearchInput' type='text' placeholder='Enter city' defaultValue={city} style={searchBooksStyle} onKeyDown={this.input} />\r\n              <input id='state' className='bookSearchInput' type='text' placeholder='Enter state' defaultValue={state} style={searchBooksStyle} onKeyDown={this.input} />\r\n              <input id='country' className='bookSearchInput' type='text' placeholder='Enter country' defaultValue={country} style={searchBooksStyle} onKeyDown={this.input} />\r\n              <button id='filteredSearchButton' style={searchBooksStyle} onClick={this.clickSearch}>Search</button>\r\n              <Users users={this.state.users}  requestBook={this.requestBook} cancelRequest={this.cancelRequest} acceptRequest={this.acceptRequest} rejectRequest={this.rejectRequest} cancelLoan={this.cancelLoan} deleteBook={this.deleteBook} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n    } else {\n      return (\n        <div className='frame' style={{paddingTop: '0px'}}>\n          <div className='page'>\n            <div className='formBox'>\n              <div>Nothing to display</div>\n            </div>\n          </div>\n        </div>\n      )\n    }\r\n  }\r\n}\r\n\r\nvar Users = function(props) {\r\n  var users = props.users.map(function(user, i) {\r\n    return <BookRows key={i} userIndex={i} user={user} requestBook={props.requestBook} cancelRequest={props.cancelRequest} acceptRequest={props.acceptRequest} rejectRequest={props.rejectRequest} cancelLoan={props.cancelLoan} deleteBook={props.deleteBook} />\r\n  })\r\n  return (\r\n    <table>{users}</table>\r\n  )\r\n}\r\n\r\nvar BookRows = function(props) {\r\n  var totalUserBooks = props.user.local.books.length\r\n  var books = []\r\n  var bookRow = []\r\n  for (let i = 0; i < totalUserBooks; i++) {\r\n    var book = props.user.local.books[i]\r\n    bookRow.push(book)\r\n    if (bookRow.length === bookTableColumns || i === totalUserBooks - 1) {\r\n      books.push(bookRow)\r\n      bookRow = []\r\n    }\r\n  }\r\n  var bookRows = books.map(function(row, i) {\r\n    return <Books key={props.userIndex + '_' + i} userIndex={props.userIndex} row={row} rowIndex={i} user={props.user} requestBook={props.requestBook} cancelRequest={props.cancelRequest} acceptRequest={props.acceptRequest} rejectRequest={props.rejectRequest} cancelLoan={props.cancelLoan} deleteBook={props.deleteBook} />\r\n  })\r\n  return (\r\n    <tbody>{bookRows}</tbody>\r\n  )\r\n}\r\n\r\nvar Books = function(props) {\r\n  var books = props.row.map(function(book, i) {\r\n    var isbn = props.user.local.isbns[props.rowIndex * bookTableColumns + i]\r\n    var src\r\n    book.cover ? src = book.cover.medium : src = '/public/images/NoImageAvailable.png'\r\n    var requestsFromUsernameFound = false\r\n    if (book.requestsFrom) {\r\n      for (let i = 0; i < book.requestsFrom.length; i++) {\r\n        if (book.requestsFrom[i].local.username === username) {\r\n          requestsFromUsernameFound = true\r\n          break\r\n        }\r\n      }\r\n    }\r\n    var lendingToUsernameFound\r\n    !book.lendingTo ? lendingToUsernameFound = false : book.lendingTo.local.username === username ? lendingToUsernameFound = true : lendingToUsernameFound = false\r\n    var combinedStyle\r\n    (pathname === '/searchBooks' && props.user.local.username === username) || (pathname === '/myBooks' && props.user.local.username !== username) || (pathname === '/myRequestsAndBorrowings' && !requestsFromUsernameFound && !lendingToUsernameFound) ? combinedStyle = {display: 'none'} : combinedStyle = {display: ''}\r\n    var requestButtonStyle\r\n    props.user.local.username !== username && !requestsFromUsernameFound && !lendingToUsernameFound ? requestButtonStyle = {display: ''} : requestButtonStyle = {display: 'none'}\r\n    var cancelRequestButtonStyle\r\n    requestsFromUsernameFound ? cancelRequestButtonStyle = {display: ''} : cancelRequestButtonStyle = {display: 'none'}\r\n    var onLoanToInfo\r\n    book.lendingTo ? onLoanToInfo = book.lendingTo.local.username + ' from ' + book.lendingTo.local.city + ', ' + book.lendingTo.local.state + ', ' + book.lendingTo.local.country + '.' : onLoanToInfo = 'No one'\r\n    var displayedEmail\r\n    book.lendingTo ? displayedEmail = book.lendingTo.local.email : ''\r\n    var onLoanToEmailDisplayStyle\r\n    pathname === '/myBooks' && onLoanToInfo !== 'No one' ? onLoanToEmailDisplayStyle = {display: ''} : onLoanToEmailDisplayStyle = {display: 'none'}\r\n    var onLoanInfo\r\n    book.lendingTo ? onLoanInfo = 'Yes' : onLoanInfo = 'No'\r\n    var ownerDetailsDisplayStyle\r\n    pathname === '/myRequestsAndBorrowings' && book.lendingTo ? ownerDetailsDisplayStyle = {display: ''} : ownerDetailsDisplayStyle = {display: 'none'}\r\n    var requestsFromCount\r\n    book.requestsFrom ? requestsFromCount = book.requestsFrom.length : requestsFromCount = '0'\r\n    var cancelLoanButtonStyle\r\n    book.lendingTo && props.user.local.username === username ? cancelLoanButtonStyle = {display: ''} : cancelLoanButtonStyle = {display: 'none'}\r\n    var cancelLoanButtonId\r\n    book.lendingTo ? cancelLoanButtonId = 'cancelLoan_' + book.lendingTo.local.username + '_' + isbn + '_' + (props.rowIndex * bookTableColumns + i) : cancelLoanButtonId = ''\r\n    var deleteBookButtonStyle\r\n    props.user.local.username === username && !book.lendingTo && !book.requestsFrom ? deleteBookButtonStyle = {display: ''} : deleteBookButtonStyle = {display: 'none'}\r\n    return (\r\n      <td key={props.userIndex + '_' + props.rowIndex + '_' + i} style={combinedStyle}>\r\n        <img src={src} />\r\n        <div>Title: <a href={book.url} target='_blank'><span>{book.title}</span></a></div>\r\n        <div>Author: <a href={book.authors[0].url} target='_blank'><span>{book.authors[0].name}</span></a></div>\r\n        <div>Location: {props.user.local.city}, {props.user.local.state}, {props.user.local.country}</div>\r\n        <div style={ownerDetailsDisplayStyle}>Owner: {props.user.local.username}</div>\r\n        <div style={ownerDetailsDisplayStyle}>Email: {props.user.local.email}</div>\r\n        <div id={'message_' + props.userIndex + '_' + (props.rowIndex * bookTableColumns + i)} className='bookMessage' style={{visibility: 'hidden'}}>Filler</div>\r\n        <div>Requesters:</div>\r\n        <div style={myBooksStyle}><RequestsFrom book={book} isbn={isbn} bookIndex={props.rowIndex * bookTableColumns + i} acceptRequest={props.acceptRequest} rejectRequest={props.rejectRequest} /></div>\r\n        <div style={notMyBooksStyle}>({requestsFromCount})</div>\r\n        <button id={'requestBook_' + props.user.local.username + '_' + props.userIndex + '_' + (props.rowIndex * bookTableColumns + i)} style={requestButtonStyle} onClick={props.requestBook}>Request this book</button>\r\n        <button id={'cancelRequest_' + props.user.local.username + '_' + props.userIndex + '_' + (props.rowIndex * bookTableColumns + i)} style={cancelRequestButtonStyle} onClick={props.cancelRequest}>Cancel request</button>\r\n        <div style={myBooksStyle}>On loan to:<div>{onLoanToInfo}<div style={onLoanToEmailDisplayStyle}> Email: {displayedEmail}.</div></div></div>\r\n        <div style={notMyBooksStyle}>On loan:<div>{onLoanInfo}</div></div>\r\n        <button id={cancelLoanButtonId} style={cancelLoanButtonStyle} onClick={props.cancelLoan}>Cancel loan</button>\r\n        <button id={'deleteBook_' + isbn + '_' + (props.rowIndex * bookTableColumns + i)} style={deleteBookButtonStyle} onClick={props.deleteBook}>Delete book</button>\r\n      </td>\r\n    )\r\n  })\r\n  return (\r\n    <tr>{books}</tr>\r\n  )\r\n}\r\n\r\nvar RequestsFrom = function(props) {\r\n  if (props.book.requestsFrom) {\r\n    var requestsFrom = props.book.requestsFrom.map(function(requester, i) {\r\n      var acceptRequestIconStyle\r\n      props.book.lendingTo ? acceptRequestIconStyle = {display: 'none'} : acceptRequestIconStyle = {display: ''}\r\n      return <div key={'requestsFrom' + '_' + props.userIndex + '_' + props.bookIndex + '_' + i}>{requester.local.username} from {requester.local.city}, {requester.local.state}, {requester.local.country}.<div style={myBooksStyle}> Email: {requester.local.email}.</div> <i id={'accept_' + requester.local.username + '_' + props.isbn + '_' + props.bookIndex} className='fa fa-check' style={acceptRequestIconStyle} onClick={props.acceptRequest}></i><i id={'reject_' + requester.local.username + '_' + props.isbn + '_' + props.bookIndex} className='fa fa-remove' onClick={props.rejectRequest}></i></div>\r\n    })\r\n    return (\r\n      <div>\r\n        {requestsFrom}\r\n      </div>\r\n    )\r\n  } else {\r\n    return <div>No one</div>\r\n  }\r\n}\r\n\r\nReactDOM.render(<DisplayBooks />, document.getElementById('target'))\r\n"
  ]
}
